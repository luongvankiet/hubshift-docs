---
title: Security
description: Security practices and compliance for Hubshift
navigation:
  icon: i-lucide-shield
seo:
  title: Hubshift Security
  description: Security measures, authentication, authorization, and compliance information
---

# Security

Hubshift implements comprehensive security measures to protect user data, ensure secure authentication, and maintain compliance with data protection regulations.

## Authentication Security

### JWT Token Security

#### Token Structure
- **Header**: Algorithm and token type
- **Payload**: User ID, expiration time
- **Signature**: HMAC SHA256 signature

#### Token Storage
- **Web**: HTTP-only cookies (prevents XSS attacks)
- **Mobile**: Secure storage (Keychain/Keystore)
- **Never**: localStorage or sessionStorage

#### Token Expiry
- **Access Token**: 24 hours (configurable)
- **Refresh Token**: 30 days (configurable)
- **Automatic Refresh**: Before expiry

### Password Security

#### Password Requirements
- Minimum 8 characters
- At least one uppercase letter
- At least one lowercase letter
- At least one number
- At least one special character

#### Password Hashing
- **Algorithm**: bcrypt
- **Salt Rounds**: 10
- **One-way Hashing**: Passwords cannot be decrypted

#### Password Reset
- Secure token generation
- Time-limited reset links
- Single-use tokens
- Email verification required

### Multi-Factor Authentication

#### Email Verification
- OTP sent to registered email
- Time-limited OTP (typically 10 minutes)
- Resend capability with rate limiting

#### SMS Verification (Optional)
- Twilio integration
- OTP via SMS
- Rate limiting to prevent abuse

## Authorization & Access Control

### Role-Based Access Control (RBAC)

#### User Roles
- **Super Admin**: Full system access
- **General Manager**: High-level oversight
- **Supervisor**: Team management
- **Health Carer**: Limited to own data and assigned clients
- **Support Coordinator**: Client coordination access
- **Client**: Own data only
- **Service Provider**: Service-specific access
- **Accountant**: Financial data access
- **Plan Manager**: Plan management access

#### Permission Model
```javascript
// Example: Role-based route protection
router.get('/admin-only', 
  isLoggedIn, 
  customRole('superAdmin', 'generalManager'), 
  adminController
);
```

### Resource-Level Permissions

#### Client Data Access
- Health carers: Only assigned clients
- Support coordinators: Their clients only
- Clients: Own data only
- Supervisors: Team's clients

#### Worker Data Access
- Workers: Own profile only
- Supervisors: Team members
- HR/Admin: All workers

### API Endpoint Protection

#### Middleware Stack
```
Request
  ↓
CORS Middleware
  ↓
Body Parser
  ↓
Authentication Middleware (isLoggedIn/isLoggedInMobile)
  ↓
Authorization Middleware (customRole)
  ↓
Route Handler
```

## Data Security

### Input Validation & Sanitization

#### Validation
- **Library**: Yup, Validator.js
- **Server-side**: Always validate on backend
- **Client-side**: Improve UX, not security

#### Sanitization
- **MongoDB Injection**: mongo-sanitize
- **XSS Prevention**: Input sanitization
- **SQL Injection**: N/A (NoSQL database)

#### File Upload Security
- **File Type Validation**: Whitelist approach
- **File Size Limits**: 10MB max
- **Virus Scanning**: ClamAV integration (optional)
- **Storage**: AWS S3 with access controls

### Data Encryption

#### In Transit
- **HTTPS**: TLS 1.2+ in production
- **Certificate**: Valid SSL certificate
- **HSTS**: HTTP Strict Transport Security

#### At Rest
- **Database**: MongoDB encryption at rest (if enabled)
- **S3**: Server-side encryption
- **Sensitive Fields**: Additional encryption for PII

### Data Privacy

#### Personal Information Protection
- **PII Handling**: Minimal collection
- **Data Retention**: As per policy
- **Right to Deletion**: User data deletion capability
- **Data Export**: User data export functionality

#### GDPR Compliance
- **Consent Management**: User consent tracking
- **Data Portability**: Export user data
- **Right to Erasure**: Delete user data
- **Privacy Policy**: Clear privacy policy

## Infrastructure Security

### AWS Security

#### IAM (Identity and Access Management)
- **Principle of Least Privilege**: Minimum required permissions
- **Role-Based Access**: IAM roles for services
- **Access Keys**: Rotated regularly
- **MFA**: Multi-factor authentication for admin accounts

#### Network Security
- **VPC**: Virtual Private Cloud isolation
- **Security Groups**: Firewall rules
- **NACLs**: Network Access Control Lists
- **Private Subnets**: Database in private subnet

#### S3 Security
- **Bucket Policies**: Access control
- **Encryption**: Server-side encryption
- **Versioning**: File versioning enabled
- **Lifecycle Policies**: Automatic archival

#### CloudWatch Security
- **Log Encryption**: Encrypted logs
- **Access Logging**: Audit trail
- **Alerts**: Security event alerts

### Application Security

#### Environment Variables
- **Storage**: AWS SSM Parameter Store
- **Encryption**: Encrypted at rest
- **Access**: IAM-based access control
- **Rotation**: Regular credential rotation

#### Secrets Management
- **JWT Secret**: Stored in SSM
- **Database Credentials**: SSM Parameter Store
- **API Keys**: Encrypted storage
- **No Hardcoding**: Never commit secrets

### Database Security

#### MongoDB Security
- **Authentication**: Username/password required
- **Authorization**: Role-based access
- **Connection**: Encrypted connections
- **Backup Encryption**: Encrypted backups

#### Query Security
- **Parameterized Queries**: Mongoose ODM
- **Injection Prevention**: mongo-sanitize
- **Input Validation**: Always validate input
- **Output Sanitization**: Sanitize output

## API Security

### Rate Limiting

#### Implementation
- **Login Endpoints**: Stricter limits
- **General Endpoints**: Standard limits
- **File Upload**: Size and frequency limits
- **Prevention**: DDoS protection

#### Rate Limit Headers
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1640995200
```

### CORS Configuration

#### Production CORS
```javascript
app.use(cors({
  origin: ['https://app.hubshift.au', 'https://admin.hubshift.au'],
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE'],
  allowedHeaders: ['Content-Type', 'Authorization']
}));
```

### Request Validation

#### Body Size Limits
- **JSON**: 50MB max
- **URL Encoded**: 50MB max
- **File Upload**: 10MB max per file

#### Request Timeout
- **Default**: 30 seconds
- **File Upload**: 5 minutes
- **Long Operations**: Configurable

## Security Monitoring

### Logging

#### Security Events
- **Failed Login Attempts**: Logged and monitored
- **Unauthorized Access**: Alerted
- **Suspicious Activity**: Flagged
- **Data Access**: Audit trail

#### Log Management
- **Winston**: Application logging
- **CloudWatch**: Centralized logging
- **Log Retention**: 90 days (configurable)
- **Log Encryption**: Encrypted at rest

### Monitoring

#### Metrics
- **Failed Authentication**: Tracked
- **API Errors**: Monitored
- **Response Times**: Performance monitoring
- **Resource Usage**: Resource monitoring

#### Alerts
- **Security Breaches**: Immediate alerts
- **Anomalies**: Automated detection
- **Thresholds**: Configurable thresholds
- **Notifications**: Email/SMS alerts

## Compliance

### NDIS Compliance
- **Incident Reporting**: NDIS standards
- **Documentation**: Required documentation
- **Audit Trails**: Complete audit trails
- **Data Retention**: As per NDIS requirements

### Data Protection
- **Privacy Act**: Australian Privacy Act compliance
- **GDPR**: GDPR compliance (if applicable)
- **Data Breach**: Breach notification procedures
- **Privacy Policy**: Clear privacy policy

### Industry Standards
- **OWASP Top 10**: Protection against common vulnerabilities
- **Security Best Practices**: Industry-standard practices
- **Regular Audits**: Security audits
- **Penetration Testing**: Regular testing

## Security Best Practices

### Development
1. **Secure Coding**: Follow secure coding practices
2. **Code Review**: Security-focused code reviews
3. **Dependency Scanning**: Regular dependency updates
4. **Vulnerability Assessment**: Regular assessments

### Deployment
1. **Environment Separation**: Dev, staging, production
2. **Secrets Management**: Never commit secrets
3. **Access Control**: Limit deployment access
4. **Rollback Plan**: Secure rollback procedures

### Operations
1. **Regular Updates**: Keep dependencies updated
2. **Security Patches**: Apply promptly
3. **Access Reviews**: Regular access reviews
4. **Incident Response**: Clear incident response plan

## Incident Response

### Security Incident Procedure
1. **Detection**: Identify security incident
2. **Containment**: Isolate affected systems
3. **Investigation**: Determine scope and impact
4. **Remediation**: Fix vulnerabilities
5. **Notification**: Notify affected parties
6. **Documentation**: Document incident and response
7. **Review**: Post-incident review

### Contact
- **Security Team**: security@hubshift.au
- **Emergency**: [Emergency contact]
- **Bug Bounty**: [If applicable]

